<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A Rust board support package (BSP) for the Teensy 4."><title>teensy4_bsp - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-b21aa549bf6d91ff.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="teensy4_bsp" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.0-nightly (a8a1d3a77 2024-04-29)" data-channel="nightly" data-search-js="search-bf21c90c8c1d92b1.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-e32f0c247825364d.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-09095024cf37855e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../teensy4_bsp/index.html">teensy4_bsp</a><span class="version">0.4.8</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../teensy4_bsp/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Type ‘S’ or ‘/’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings">Settings</a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">teensy4_bsp</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/teensy4_bsp/lib.rs.html#1-255">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A Rust board support package (BSP) for the Teensy 4.</p>
<p><code>teensy4-bsp</code> supports the following boards:</p>
<ul>
<li>Teensy 4.0</li>
<li>Teensy 4.1</li>
<li>Teensy MicroMod</li>
</ul>
<p>If you’re just getting started with embedded Rust development on the Teensy 4, take
a look at <a href="board/index.html" title="mod teensy4_bsp::board">the <code>board</code> module</a>. This module provides pre-configured drivers
and helper functions to define hardware drivers.</p>
<p>Peripherals are re-exported from the <a href="crate::hal"><code>imxrt-hal</code></a>
hardware abstraction layer. For more information on drivers, consult the <code>imxrt-hal</code> documentation.
Note that <code>imxrt-hal</code> drivers depend on low-level resources from <code>imxrt-ral</code>. For convenience,
the BSP also exposes <a href="crate::ral"><code>imxrt-ral</code></a>. Combine <code>imxrt-hal</code> and <code>imxrt-ral</code> to have full
control of your hardware.</p>
<p>Finally, the BSP provides a runtime to simplify application development. It exposes board pins through
the [<code>pins</code>] module. And, it provides the <a href="crate::logging"><code>imxrt-log</code></a> API for advanced
logging features.</p>
<h2 id="features"><a class="doc-anchor" href="#features">§</a>Features</h2>
<p><code>teensy4-bsp</code> supports these features.</p>
<div><table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&quot;rt&quot;</code></td><td>Adds runtime support using <code>imxrt-rt</code>.</td></tr>
<tr><td><code>&quot;usb-logging&quot;</code></td><td>Enables the <a href="enum.LoggingFrontend.html" title="enum teensy4_bsp::LoggingFrontend"><code>LoggingFrontend</code></a> convenience.</td></tr>
</tbody></table>
</div>
<p>When <code>&quot;usb-logging&quot;</code> is enabled, the BSP defines the <code>USB_OTG1</code> interrupt handler.
This may conflict with your own <code>USB_OTG1</code> handler, resulting in a duplicate definition.
If you want to define your own <code>USB_OTG1</code> handler to perform USB logging, do not enable
<code>&quot;usb-logging&quot;</code>.</p>
<h2 id="runtime"><a class="doc-anchor" href="#runtime">§</a>Runtime</h2>
<p>When the runtime is enabled, <code>teensy4-bsp</code> defines the memory map. In order to use the memory map,
you must <strong>link your program with <code>t4link.x</code></strong>.</p>
<p>The memory organization includes</p>
<ul>
<li>320 KiB of DTCM, comprised of
<ul>
<li>a 16 KiB stack.</li>
<li>the vector table.</li>
<li>all zero- and runtime-initialized data (<code>.bss</code>, <code>.data</code>).</li>
</ul>
</li>
<li>192 KiB of ITCM, containing <em>all</em> instructions (<code>.text</code>).</li>
<li>512 KiB of OCRAM, comprised of
<ul>
<li>any uninitialized data (<code>.uninit</code>)</li>
<li>a 16 KiB heap.</li>
</ul>
</li>
</ul>
<p>If the runtime is disabled, then <code>teensy4-bsp</code> does no define the memory map, and it does not
depend on <code>imxrt-rt</code>. Consider disabling the BSP’s runtime feature if you want to implement your
own runtime, or if you want to use <code>imxrt-rt</code> to define your own memory map.</p>
<h3 id="environment-variable-overrides"><a class="doc-anchor" href="#environment-variable-overrides">§</a>Environment variable overrides</h3>
<p>You can override the size of some memory regions by setting environment variables.</p>
<ul>
<li>To change the <em>stack</em> size, set <code>TEENSY4_STACK_SIZE</code> when building.</li>
<li>To change the <em>heap</em> size, set <code>TEENSY4_HEAP_SIZE</code> when building.</li>
</ul>
<p>The examples below show how to set a 4096 byte stack using its environment variable.</p>
<div class="example-wrap"><pre class="language-text"><code>TEENSY4_STACK_SIZE=4096
TEENSY4_STACK_SIZE=4k     # Convenience for multiples of 1024 bytes.
TEENSY4_STACK_SIZE=4K     # Equivalent to the above.
</code></pre></div><h2 id="notes"><a class="doc-anchor" href="#notes">§</a>Notes</h2><h3 id="srtc-reset-by-loader"><a class="doc-anchor" href="#srtc-reset-by-loader">§</a>SRTC reset by loader</h3>
<p>When the SRTC is enabled, setting the board into program mode then using the Teensy Loader
application (GUI) to reboot it will set the current time (Unix epoch, but time in local
timezone). This will overwrite whatever time you may have previously set and is ambiguous
around the backwards daylight savings transition point.</p>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.hal"><code>pub use imxrt_hal as hal;</code></div></li><li><div class="item-name" id="reexport.logging"><code>pub use imxrt_log as logging;</code></div></li><li><div class="item-name" id="reexport.ral"><code>pub use imxrt_ral as ral;</code></div></li><li><div class="item-name" id="reexport.rt"><code>pub use imxrt_rt as rt;</code></div><div class="desc docblock-short"><span class="stab portability" title="Available on crate feature `rt` only"><code>rt</code></span></div></li><li><div class="item-name" id="reexport.pins"><code>pub use teensy4_pins as pins;</code></div></li></ul><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="board/index.html" title="mod teensy4_bsp::board">board</a></div><div class="desc docblock-short">Pre-configured board resources.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.LoggingFrontend.html" title="enum teensy4_bsp::LoggingFrontend">LoggingFrontend</a><span class="stab portability" title="Available on crate features `rt` and `usb-logging` only"><code>rt</code> and <code>usb-logging</code></span></div><div class="desc docblock-short">The logging frontend.</div></li></ul><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.EXT_SYSTICK_HZ.html" title="constant teensy4_bsp::EXT_SYSTICK_HZ">EXT_SYSTICK_HZ</a></div><div class="desc docblock-short">SYSTICK external clock frequency.</div></li></ul></section></div></main></body></html>